
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Assignment #4 (demo) &#8212; Mlcourse.ai</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Mlcourse.ai</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="landing-page.html">
   My book title
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="assignment01_pandas_uci_adult.html">
   mlcourse.ai - Open Machine Learning Course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment01_pandas_uci_adult.html#center-assignment-1-demo">
   <center>
    Assignment #1 (demo)
   </center>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment01_pandas_uci_adult_solution.html">
   mlcourse.ai - Open Machine Learning Course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment01_pandas_uci_adult_solution.html#center-assignment-1-demo-solution">
   <center>
    Assignment #1 (demo). Solution
   </center>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment10_flight_delays_kaggle.html">
   <center>
    Assignment #10 (demo)
   </center>
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/assignment04_linreg_optimization.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/assignment04_linreg_optimization.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#center-linear-regression-as-an-optimization-problem">
   <center>
    Linear Regression as an optimization problem
   </center>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-1-basic-data-analysis-with-pandas">
     Part 1. Basic data analysis with Pandas
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-2-squared-error-minimization">
   Part 2. Squared Error Minimization
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <center>
<img src="../../img/ods_stickers.jpg">
## Open Machine Learning Course
<center>Author: [Yury Kashnitsky](https://www.linkedin.com/in/festline/), Data Scientist at Mail.ru Group <br>
Translated by [Anna Larionova](https://www.linkedin.com/in/anna-larionova-74434689/), DS @ Picturer, Data4, BNTouch <br> All content is distributed under the [Creative Commons CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/) license.<div class="section" id="center-assignment-4-demo">
<h1><center> Assignment #4 (demo)<a class="headerlink" href="#center-assignment-4-demo" title="Permalink to this headline">¶</a></h1>
<div class="section" id="center-linear-regression-as-an-optimization-problem">
<h2><center> Linear Regression as an optimization problem<a class="headerlink" href="#center-linear-regression-as-an-optimization-problem" title="Permalink to this headline">¶</a></h2>
<p>(no solution shared, part of <a class="reference external" href="https://ru.coursera.org/specializations/machine-learning-data-analysis">this</a> Coursera specialization)</p>
<div class="section" id="part-1-basic-data-analysis-with-pandas">
<h3>Part 1. Basic data analysis with Pandas<a class="headerlink" href="#part-1-basic-data-analysis-with-pandas" title="Permalink to this headline">¶</a></h3>
<p>In this task we will use <a class="reference external" href="http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data_Dinov_020108_HeightsWeights">SOCR</a> data containing information about height and weight of 25 thousands teenagers.</p>
<p><strong>[1]. If you haven’t installed yet Seaborn library you should execute <em>conda install seaborn</em> in the terminal. (Seaborn isn’t part of Anaconda and it provides suitable high level functionality for data visualization).</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>Read the data about height and weight into Pandas DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../../data/weights_heights.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>First thing you should do after reading the data is to look at first records. It helps to find the data reading errors (for example, when we have 1 column instead of 10 and it has 9 dots with commas in column name). Also it allows to take a closer look at the data and features and their nature (numerical, categorical, etc.).</p>
<p>Than we should plot histograms of feature distributions. Also it can help to understand features nature (power-series distribution or standard or something else). Histogram can help us find some values that aren’t similar to each other - outliers.
It is convenient to plot histograms using <em>plot</em> method of Pandas DataFrame with option <em>kind=’hist’</em>.</p>
<p><strong>Example.</strong> Let’s plot the histogram of teenager’s height distribution. We use method <em>plot</em> for DataFrame <em>data</em> with options <em>y=’Height’</em> (the feature which distribution we want to plot).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Height&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> 
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Height (inch.) distribution&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/assignment04_linreg_optimization_9_0.png" src="_images/assignment04_linreg_optimization_9_0.png" />
</div>
</div>
<p>Options:</p>
<ul class="simple">
<li><p><em>y=’Height’</em> - the feature which distribution we want to plot</p></li>
<li><p><em>kind=’hist’</em> - means that plot type is histogram</p></li>
<li><p><em>color=’red’</em> - set color</p></li>
</ul>
<p><strong>[2]. Look at the first 5 rows using <em>head</em> method of Pandas DataFrame. Plot the histogram of weight distribution using method <em>plot</em> Pandas DataFrame. Make the color of histogram to be green and add title.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p>One of the most effective methods of basic data analysis is mapping pairwise dependencies of features. We make <span class="math notranslate nohighlight">\(m \times m\)</span> plots (<em>m</em> is number of features) where we have histograms of feature distributions in diagonal and scatter plots of two feature dependencies outside. We can do this using <span class="math notranslate nohighlight">\(scatter\_matrix\)</span> method of Pandas Data Frame or <em>pairplot</em> of Seaborn library.</p>
<p>To illustrate this method we add third feature. Let’s create <em>bodymass index</em> (<a class="reference external" href="https://en.wikipedia.org/wiki/Body_mass_index">BMI</a>). To do this we use <em>apply</em> method of Pandas FataFrame and Python’s lambda functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_bmi</span><span class="p">(</span><span class="n">height_inch</span><span class="p">,</span> <span class="n">weight_pound</span><span class="p">):</span>
    <span class="n">METER_TO_INCH</span><span class="p">,</span> <span class="n">KILO_TO_POUND</span> <span class="o">=</span> <span class="mf">39.37</span><span class="p">,</span> <span class="mf">2.20462</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">weight_pound</span> <span class="o">/</span> <span class="n">KILO_TO_POUND</span><span class="p">)</span> <span class="o">/</span> \
           <span class="p">(</span><span class="n">height_inch</span> <span class="o">/</span> <span class="n">METER_TO_INCH</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;BMI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">make_bmi</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Height&#39;</span><span class="p">],</span> 
                                              <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Weight&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>[3]. Create the picture that contains pairwise dependencies of features ‘Height’, ‘Weight’ и ‘BMI’. You should use <em>pairplot</em> method of Seaborn library.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p>During the basic analysis you often have to investigate dependencies of numerical from categorical features (for example, dependency between salary and employee sex). In this case we can use boxplots from Seaborn library. Box plot is a compact way to show real value statistics (mean and quartiles) by different values of categorical feature. It also helps to find outliers - observations that have very different values from others.</p>
<p><strong>[4]. Create new feature <em>weight_category</em> in DataFrame <em>data</em> that will have 3 values: 1 if the weight is less than 120 pounds, 3 if the weight is greater or equal to 150 pounds, 2 in other cases. Create boxplot showing dependency between height and weight category. Use <em>boxplot</em> method of Seaborn library and <em>apply</em> method of Pandas DataFrame. Add titles “Height” to <em>y</em> axis and “Weight category” to <em>x</em> axis.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">weight_category</span><span class="p">(</span><span class="n">weight</span><span class="p">):</span>
    <span class="k">pass</span>
    <span class="c1"># Your code here</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight_cat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">weight_category</span><span class="p">)</span>
<span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>[5]. Create scatter plot of dependencies between height and weight using <em>plot</em> method for Pandas DataFrame with option <em>kind=’scatter’</em>. Add title to the figure.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="part-2-squared-error-minimization">
<h2>Part 2. Squared Error Minimization<a class="headerlink" href="#part-2-squared-error-minimization" title="Permalink to this headline">¶</a></h2>
<p>In basic case the task of real value prediction by other features (regression task) can be solved using squared error minimization.</p>
<p><strong>[6]. Create function computing squared error of dependency approximation between height <span class="math notranslate nohighlight">\(y\)</span> and weight <span class="math notranslate nohighlight">\(x\)</span> using straight line <span class="math notranslate nohighlight">\(y = w_0 + w_1 * x\)</span> by two parameters <span class="math notranslate nohighlight">\(w_0\)</span> and <span class="math notranslate nohighlight">\(w_1\)</span>:</strong>
$<span class="math notranslate nohighlight">\(error(w_0, w_1) = \sum_{i=1}^n {(y_i - (w_0 + w_1 * x_i))}^2 \)</span><span class="math notranslate nohighlight">\(
Where \)</span>n<span class="math notranslate nohighlight">\( is number of observations in dataset, \)</span>y_i<span class="math notranslate nohighlight">\( and \)</span>x_i<span class="math notranslate nohighlight">\( are height and weight of \)</span>i$th person in dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p>So we are solving the task how to draw a straight line through the points cloud corresponding to observations in our dataset in space of features “Height” and “Weight” to minimize function[6]. Let’s start with drawings some lines and make sure they transfer dependencies from height to weight.</p>
<p><strong>[7]. On plot from [5] Problem 1 draw two straight lines corresponding to values of parameters <span class="math notranslate nohighlight">\(w_0, w_1) = (60, 0.05)\)</span> and (<span class="math notranslate nohighlight">\(w_0, w_1) = (50, 0.16)\)</span>. Use <em>plot</em> method from <em>matplotlib.pyplot</em> and <em>linspace</em> method from NumPy library. Add the titles to axes and plot.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p>Squared error function minimization is very easy task because of the function’s convex nature. There are many optimization methods for this problem. Let’s look at dependency between error function and the first parameter (slope of the straight line) if the second parameter (absolute term) is fixed.</p>
<p><strong>[8]. Plot dependency between error function calculated in [6] and <span class="math notranslate nohighlight">\(w_1\)</span> parameter when <span class="math notranslate nohighlight">\(w_0\)</span> = 50. Add the titles to axes and plot.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can find the slope of the straight line approximating dependency between height and weight when coefficient is fixed <span class="math notranslate nohighlight">\(w_0 = 50\)</span> using optimization method.</p>
<p><strong>[9]. Using <em>minimize_scalar</em> method from <em>scipy.optimize</em> find the minimum of the function[6] for parameter value <span class="math notranslate nohighlight">\(w_1\)</span> in range [-5,5]. Draw on plot [5] Problem 1 the straight line corresponding to the values of parameters (<span class="math notranslate nohighlight">\(w_0\)</span>, <span class="math notranslate nohighlight">\(w_1\)</span>) = (50, <span class="math notranslate nohighlight">\(w_1\_opt\)</span>) where <span class="math notranslate nohighlight">\(w_1\_opt\)</span> is optimal value of parameter <span class="math notranslate nohighlight">\(w_1\)</span> that was found in [8].</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p>When you analyze multidimensional data, you often want to get intuitive understanding about data nature using visualization. It is impossible to plot the data when you have more than 3 features. It is better to choose 2 or 3 principal components from data and represent them in plane or volume.</p>
<p>Let’s have a look how Python can draw 3D figures on example of function <span class="math notranslate nohighlight">\(z(x,y) = sin(\sqrt{x^2+y^2})\)</span> for values of <span class="math notranslate nohighlight">\(x\)</span> и <span class="math notranslate nohighlight">\(y\)</span> from interval [-5,5] with step 0.25</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
</pre></div>
</div>
</div>
</div>
<p>Create objects of type matplotlib.figure.Figure (picture) and  matplotlib.axes._subplots.Axes3DSubplot (axes).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span> <span class="c1"># get current axis</span>

<span class="c1"># Create NumPy arrays with data points on X and Y axes.</span>
<span class="c1"># Use meshgrid method creating matrix of coordinates</span>
<span class="c1"># By vectors of coordinates. Set needed function Z(x, y).</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Finally use *plot_surface* method of type object</span>
<span class="c1"># Axes3DSubplot. Add titles to axes.</span>
<span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/assignment04_linreg_optimization_37_0.png" src="_images/assignment04_linreg_optimization_37_0.png" />
</div>
</div>
<p><strong>[10]. Create 3D-plot between error function calculated in [6] and parameters <span class="math notranslate nohighlight">\(w_0\)</span> and <span class="math notranslate nohighlight">\(w_1\)</span>. Add titles “Intercept” to the <span class="math notranslate nohighlight">\(x\)</span> axis, “Slope” to the <span class="math notranslate nohighlight">\(y\)</span> axis, “Error” to the <span class="math notranslate nohighlight">\(z\)</span> axis.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>[11]. Find the minimum of the function in [6] using <em>minimize</em> method from scipy.optimize for parameters values <span class="math notranslate nohighlight">\(w_0\)</span> in range [-100,100] and <span class="math notranslate nohighlight">\(w_1\)</span> in range [-5, 5]. Starting point is (<span class="math notranslate nohighlight">\(w_0\)</span>, <span class="math notranslate nohighlight">\(w_1\)</span>) = (0, 0). Use L-BFGS-B optimization method (option method in minimize). Draw on plot from [5] Problem 1 the straight line coresponding finded optimal values of parameters <span class="math notranslate nohighlight">\(w_0\)</span> and <span class="math notranslate nohighlight">\(w_1\)</span>. Add titles to the axes and plot.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>